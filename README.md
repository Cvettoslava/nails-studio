Курсов проект по "PHP базирани работни рамки"
от Цветослава Радославова, Фак.№ 1809013484

## Тема на курсовия проект:

# Електронен графика за запазване на часове за процедура "маникюр"

### Описание:

Уеб приложението се състои от публична част, която е предназначена за администратори и неадминистратори, в която се виждат последно добавените часове в графика, съдържа още login и register форми, чрез които след регистрация и вписване приложението предоставя админ панел, откъдето може да се премине към страницата на самия график. Там могат да се видят всички добавени часове за конкретните услуги на съотвените лица (име, номер). Може да се създават нови записи, като всички данни са валидирани и при въвеждане на невалидни данни страницата се презарежда с възможност за ново коректно въвеждане. След добавяне на данни, записите се сортират по дата и час, тоест можем да видим първо най-скорошните запазени часове. Има възможност за редактиране и изтриване на записи.

### Разбработка на проекта:

### БАЗА ДАННИ:

Проектът разполага с база данни, състояща се от 5 таблици:
`failed_jobs`
`migrations`
`password_resets`
`scheduled_sessions`
`users`

### МИГРАЦИИ:

Както и с 3 миграции по подразбиране + още 2, създадени в хода на проекта:
"`2021_02_10_130601_add_admin_field_to_users_table.php`"

"`2021_02_10_141225_create_scheduled_sessions_table.php`"

И двете разполагат с 2 метода up и down, като методът `up` на миграцията
`add_admin_field_to_users_table.php` добавя още една колона в таблицата `users`, която съдържа информация дали регистрираният потребител е админ или не. А `down` методът отменя направеното в `up` метода.

В метода `up` на миграция `create_scheduled_sessions_table.php` се създава таблица, в която се добавя всеки новосъздаден запис в графика. Методът `down` го отменя.

За проверката дали даден потребител е админ или не, се грижи контролера `AdminMiddleware`, който потвърждава, че потребителят на приложението е удостоверен. Ако потребителят не е удостоверен, контролерът ще го пренасочи към екрана за вход на приложението. Ако обаче потребителят е удостоверен, ще позволи на заявката да продължи по-нататък в приложението.
Към базата данни имаме създаден и един seeder, в който дефинираме 2 масива: с произволни имена на клиенти и възможните услуги, като целта на seeder-а е да запълни таблицата с произволни записи.

### КОНТРОЛЕРИ:

`AdminController`: има конструктор, в който се задава, че контролерът използва `AdminMiddleWare`, който прави проверката дали потребителя е админ, и метод, който връща view за `admin.dashboard`.

#### AdminScheduleController

`AdminScheduleController`: съдържа функции за оперирането със записи в графика.

`function index()` - Сортира записите по дата и време и връща view-то на страницата, където се намира графика.

`function create()` - Връща view-то на страницата за създаване на нов запис.

`function store()` - Задава правила за валидни данни и ако всички данни за валидни запазва новия запис, след което ни пренасочва към view-то на страницата, където се намира графика.

`function edit($id)` - взема id-то на записа, който желаем да редактираме, след което връща view на конкретния запис като използва класа Carbon за показване на създадените в записа данни.

`function update()` - прави същото като `function store()` с тази разлика, че приема два параметъра - Request и id-то на записа, който актуализираме като връща вече актуализираното view.

`function destroy($id)` - търси записа по id, извиква функацията `delete()` и връща view-to на страницата, където е графика.

`function delete($id)` - търси записа по id и връща view-то на `delete` страницата.

#### HomeController:

`function index()`- връща view-то на home страницата, която дава информация, че потребителят/администраторът се е вписал успешно.
`function welcome()`- взема сортирани по `scheduled_time` последните 6 записа и връща view-то на страницата `welcome`.

Всички контролери наследяват класа `Controller`, който наследява `BaseController`.

### МОДЕЛИ:

`User`

`ScheduledSession`

### ROUTES:

`Route::get('/', [App\Http\Controllers\HomeController::class,'welcome'])->name ('welcome');` - за достъп до маршрута `[App\Http\Controllers\HomeController::class,'welcome']`, тоест view-то на страницата "welcome" от контролера `HomeController` се използва пътя "/".

`Route::get('/home', [App\Http\Controllers\HomeController::class, 'index'])->middleware('auth')->name('home');` - за достъп до маршрута
`[App\Http\Controllers\HomeController::class, 'index']`, тоест view-то на страницата "index" в контролера `HomeController` се използва за "/home", като използва auth middleware за проверка дали потребителя се е логнал в системата.

`Route::get('/admin',[App\Http\Controllers\AdminController::class, 'dashboard'])->name('admin.dashboard');` - за достъп до маршрута `[App\Http\Controllers\AdminController::class, 'dashboard']`, тоест view-то на страницата "dashboard" от `AdminController` се използва "/admin".

`Route::resource('/admin/schedule', App\Http\Controllers\AdminScheduleController::class);` - регистрира маршрут на ресурс(в случая schedule, т.е. графика), който сочи към контролера `AdminScheduleController`, който съдържа методите за всяка от наличните операции с ресурса.

`Route::get('/admin/schedule/{schedule}/delete', [App\Http\Controllers\AdminScheduleController::class, 'delete'])->name('schedule.delete');` - за достъп до маршрута [App\Http\Controllers\AdminScheduleController::class, 'delete'], тоест view-то на страницата "delete" от AdminScheduleController се използва "/admin/schedule/{schedule}/delete".
Този път е допълнение на ресурсния контролер и представлява страница за потвърждение преди изтриването на записа.
